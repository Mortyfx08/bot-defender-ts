"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ThreatFeedMetrics = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const polaris_1 = require("@shopify/polaris");
const ThreatFeedMetrics = ({ metrics, threatFeedData }) => {
    const formatDate = (dateString) => {
        if (!dateString)
            return 'Never';
        return new Date(dateString).toLocaleString();
    };
    return ((0, jsx_runtime_1.jsx)("div", { className: "threat-feed-metrics", children: (0, jsx_runtime_1.jsxs)(polaris_1.TextContainer, { children: [(0, jsx_runtime_1.jsx)(polaris_1.Text, { variant: "headingMd", as: "h2", children: "Threat Feed Metrics" }), (0, jsx_runtime_1.jsxs)("div", { className: "metrics-grid", children: [(0, jsx_runtime_1.jsxs)("div", { className: "metric-card", children: [(0, jsx_runtime_1.jsx)(polaris_1.Text, { variant: "headingLg", as: "h3", children: metrics.totalThreatFeedIPs }), (0, jsx_runtime_1.jsx)(polaris_1.Text, { as: "p", children: "Total Threat Feed IPs" })] }), (0, jsx_runtime_1.jsxs)("div", { className: "metric-card", children: [(0, jsx_runtime_1.jsx)(polaris_1.Text, { variant: "headingLg", as: "h3", children: metrics.threatFeedBlocks }), (0, jsx_runtime_1.jsx)(polaris_1.Text, { as: "p", children: "Threat Feed Blocks" })] }), (0, jsx_runtime_1.jsxs)("div", { className: "metric-card", children: [(0, jsx_runtime_1.jsx)(polaris_1.Text, { variant: "headingLg", as: "h3", children: formatDate(metrics.lastUpdate) }), (0, jsx_runtime_1.jsx)(polaris_1.Text, { as: "p", children: "Last Update" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "metrics-grid", children: [(0, jsx_runtime_1.jsxs)("div", { className: "metric-card severity-high", children: [(0, jsx_runtime_1.jsx)(polaris_1.Text, { variant: "headingLg", as: "h3", children: metrics.threatFeedHighSeverity }), (0, jsx_runtime_1.jsx)(polaris_1.Text, { as: "p", children: "High Severity" })] }), (0, jsx_runtime_1.jsxs)("div", { className: "metric-card severity-medium", children: [(0, jsx_runtime_1.jsx)(polaris_1.Text, { variant: "headingLg", as: "h3", children: metrics.threatFeedMediumSeverity }), (0, jsx_runtime_1.jsx)(polaris_1.Text, { as: "p", children: "Medium Severity" })] }), (0, jsx_runtime_1.jsxs)("div", { className: "metric-card severity-low", children: [(0, jsx_runtime_1.jsx)(polaris_1.Text, { variant: "headingLg", as: "h3", children: metrics.threatFeedLowSeverity }), (0, jsx_runtime_1.jsx)(polaris_1.Text, { as: "p", children: "Low Severity" })] })] }), threatFeedData.recentBlocks.length > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "recent-blocks", children: [(0, jsx_runtime_1.jsx)(polaris_1.Text, { variant: "headingMd", as: "h3", children: "Recent Threat Feed Blocks" }), (0, jsx_runtime_1.jsx)("div", { className: "blocks-list", children: threatFeedData.recentBlocks.map((block, index) => ((0, jsx_runtime_1.jsxs)("div", { className: "block-item", children: [(0, jsx_runtime_1.jsxs)("div", { className: "block-header", children: [(0, jsx_runtime_1.jsx)(polaris_1.Text, { variant: "bodyMd", as: "p", children: (0, jsx_runtime_1.jsxs)("strong", { children: ["IP: ", block.ip] }) }), (0, jsx_runtime_1.jsx)(polaris_1.Badge, { status: "critical", children: "Blocked" })] }), (0, jsx_runtime_1.jsxs)(polaris_1.Text, { variant: "bodySm", as: "p", children: ["Reason: ", block.reason, (0, jsx_runtime_1.jsx)("br", {}), "Blocked: ", new Date(block.blockedAt).toLocaleString(), (0, jsx_runtime_1.jsx)("br", {}), "Expires: ", new Date(block.expiresAt).toLocaleString()] })] }, index))) })] }))] }) }));
};
exports.ThreatFeedMetrics = ThreatFeedMetrics;
